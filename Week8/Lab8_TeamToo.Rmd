---
title: "Lab 8: Data Science to Solve Problems and Answer Questions, part 1"
author: "Brian Teklits, Charles Doremieux, Andrew MacLean, Clint LaBattaglia"
date: "10/18/2019"
output: html_document
---
```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
candy <- read_csv("https://www.scq.ubc.ca/wp-content/uploads/2017/10/candyhierarchy2017.csv")
Challa <- read_excel("../East Africa lake data.xlsx",sheet = 1)
Malawi <- read_excel("../East Africa lake data.xlsx",sheet = 3)
VOI <- read_excel("../East Africa lake data.xlsx",sheet = 8)
CRU_MAM <- read_excel("../East Africa lake data.xlsx",sheet = 9)
```

### Dataset and Questions

**Who is hiring us?:** A candy company seeking to develop new products.

**Overall question and it's importance:** What candies are the most universally liked? 

Understanding which candies are the most popular informs us of what qualities to keep in mind when designing a new candy.

**Why the answer matters:** There are a variety of conclusions which can be drawn depending on who the company wants their new product to target. Universally liked candies offer a safe bet, universally disliked offer some qualities to avoid, while those in between could represent somewhat effective ideas which can be improved upon.

**Description of Dataset:** The dataset can be found [here.](https://www.scq.ubc.ca/wp-content/uploads/2017/10/candyhierarchy2017.csv) It contains information from a survey, with user data on gender, age, and country/state. Users rate candy on a scale of 3: DESPAIR, MEH, JOY. Essentially, these categories translate to dislike, indifferent, or like. 

There are also many other columns describing a variety of things added onto the survey, many of which are unclear what they describe. The candy data corresponds to 104 columns, each describing a different candy and the ratings associated to it from the 2460 respondents to the survey. Mixed in with the candy ratings are a variety of gag questions.

### Individual Questions

Some ideas: 
general candy consumer demographics: gender, age, country/state
popular/unpopular candy by demographic

**Andrew's Question:**

**Why this question is interesting:**

**Brian's Question:** Which candies are the most/least popular among different age groups? Which candy, if any, is the most polarizing (Liked by one group and disliked by another)?

**Why this question is interesting:** Understanding how preferences vary among different age groups can provide intersting insights. Perhaps some candies are universally popular among all ages, while others appeal only to certain groups.

**Charles' Question:** Are there any candies which are predominantly popular to a particular sex/gender? Which candies, if any, are preferred predominantly by men or women?

**Why this question is interesting:** Understanding which candies appeal predominantly to men or women provides meaningful data to market researchers and advertisers who seek to maximize sales within their markets. Hence, such data can be invaluable.

**Clint's Question:** Does the popularity of candy vary by region or state? Are some candies unviversally popular? 

**Why this question is interesting:** By understanding where certain candies are most popular corporations can direct their marketing resources to ensure opitmize sales in already dmoinated market or to grow sales in a emerging market. 

### East Africa Lake Data Visualizations

#### Andrew's Plot
```{r}
# Malawi
head(Malawi)
```

#### Brian's Plot
```{r}
# VOI rainfall
head(VOI)
```

#### Charles' Plot
```{r}
# Challa

#head(Challa)
# Challa is already nearly tidy, it just needs the units row to be removed, have the columns be put in the right unit (doubles), and have any empty values removed.

Challa2 <- Challa %>%
  filter(!is.na(Challa$`Age AD`))

Challa2 <- Challa2 %>%
  filter(!is.na(`varve thickness`))

Challa2$`varve thickness` <- as.double(Challa2$`varve thickness`)
Challa2$`dark layer` <- as.double(Challa2$`dark layer`)
Challa2$`light layer`<- as.double(Challa2$`light layer`)

ggplot(data = Challa2)+
  geom_density(aes(x=`varve thickness`))+
  xlab('Varve Thickness (mm)')+
  ylab('Frequency')+
  ggtitle('Frequency of Measured Varve Thickness')
  #geom_smooth(aes(x=`Age AD`,y=`varve thickness`))
  
```
By measuring the frequency of varve thickness, which is directly associated with the rainfall each year, a conclusion can be made on what was the most common depth of rainfall each year. Because most varve thickness was slightly less than 1mm in thickness we know that historically most rain has been around that quantity.


#### Clint's Plot
```{r}
# CRU and MAM rainfall

tidy_lakes_9 <- CRU_MAM %>%
  select(Year, `GPCC MAM Normalized`, `CRU MAM Normalized`, `GPCC OND Normalized`, `CRU OND Normalized`) %>%
  rename(MAM =`GPCC MAM Normalized`, OND = 'GPCC OND Normalized')%>%
  gather(MAM, OND, key = 'months', value = 'GPCC_Normalized')

fin_lake <- tidy_lakes_9%>%
  rename(MAM = 'CRU MAM Normalized', OND = `CRU OND Normalized`)%>%
  gather('MAM', 'OND', key = 'months_2', value = 'CRU_Normalized') %>%
  filter(months == months_2)%>%
  select('Year', 'months', `GPCC_Normalized`, 'CRU_Normalized')
  
 ggplot() + 
  geom_smooth(data = fin_lake, mapping= aes(x= Year, y = GPCC_Normalized, color = 'GPCC')) +
  geom_smooth(data = fin_lake, mapping= aes(x= Year, y = CRU_Normalized, color = 'CRU')) +
  facet_grid(.~months) +
  ggtitle("CRU and GPCC Normalized by year faceted by month")+
  ylab("GPCC and CRU")

head(CRU_MAM)
```
By looking at the rainfall data over time faceted by the rainy season it is possible to observe the difference in rainfall between CRU and GPCC. Once the data was graphed you can see that the March April May rainy season has higher rainfall over time then the October November December rainy season. CRU has consistently higher rainfall during the MAM rainy season but during the OND rainy season the rainfall leader varies over the years.

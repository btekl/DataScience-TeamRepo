---
title: "Lab 5"
author: "Brian Teklits, Charles Doremieux, Andrew MacLean, Clint LaBattaglia"
date: "9/25/2019"
output: html_document
---

```{r setup,include=FALSE}
library(tidyverse)
milk <- read.csv('state_milk_production.csv')
milk <- milk %>%
  mutate(milk_million = milk_produced/1000000)
```


### Team Plot
```{r}
milkteam <- milk %>%
  filter(state %in% c('New York','Colorado','California','New Jersey','Washington')) %>%
  select(state, year, milk_million)
by_year <- milkteam %>%
  group_by(year) %>%
  summarise(avg = mean(milk_million))
```

```{r}
ggplot(data = milkteam, aes(x = year, y = milk_million)) +
  geom_point(aes(color = state)) +
  geom_smooth(data=by_year,aes(year, avg),method='lm',se=FALSE)+
  ggtitle('Pounds of milk over time by state') +
  xlab('Year') +
  ylab('Milk Produced (Million lb)')
```

**What does this plot convey:** The average milk production per year across the entire US has increased substantially since 1970. California, in particular, has increased its milk production by almost 4 times since 1970. New Jersey appears to have had a slight decrease in production, while the other 3 states have increased production at a modest rate.

#### Team Data Summary

**The year with the most milk produced: 2017**
```{r}
milk %>%
  group_by(year) %>%
  summarise(total_production = sum((milk_million))) %>% 
  filter(total_production == max(total_production))
```
**The year with the least milk produced: 1975**
```{r}
milk %>%
  group_by(year) %>%
  summarise(total_production = sum((milk_million))) %>% 
  filter(total_production == min(total_production))
```
**The top 5 milk producers of 2017:**
```{r}
milk %>%
  filter(year==2017) %>%
  select(state,milk_million) %>%
  arrange(desc(milk_million)) %>%
  filter(min_rank(desc(milk_million)) < 6)
```
**The bottom 5 milk producers of 2017:**
```{r}
milk %>%
  filter(year==2017) %>%
  select(state,milk_million) %>%
  arrange((milk_million)) %>%
  filter(min_rank((milk_million)) < 6)
```

#### Reflections

**What was most helpful in learning about this data:**

**Who could benefit the most from this analysis? Who could be harmed by it?:**

### Individual Sections

#### Charles' Plot

```{r}
milk1970 <- milk %>%
  filter(year == 1970)
ggplot(data = milk1970, aes(x = milk_million)) +
  geom_histogram(bins = 15) + 
  ggtitle('Histogram of Milk Produced in 1970 by State')+
  xlab("millions of gallons of milk")


ggplot(data = milk1970, aes(x = state, y = milk_million)) +
  geom_col() + 
  ggtitle('Histogram of Milk Produced in 1970 by State')+
  xlab("State")+
  ylab("millions of gallons of milk")+
  theme(axis.text.x = element_text(angle=60, hjust=1))+
  geom_text(aes(label = milk_million), vjust = -0.5)
```

**The average milk produced in year:**
```{r}
#calc avg
```
**The median milk produced in year:**
```{r}
#calc median
```
**The top producing state of year:**
```{r}
#calc max
```
**The state that produced the least in year:**
```{r}
#calc min
```


#### Brian's Plot

```{r}
milk1995 <- milk %>%
  filter(year == 1995)
ggplot(data = milk1995, aes(x = milk_million)) +
  geom_density()+
  xlab("Pounds produced in millions")+
  ggtitle('Milk produced in 1995 by state')
```

**The average milk produced in 1995:**
```{r}
milk1995 %>%
  summarise(avg = mean(milk_million))
```
**The median milk produced in 1995:**
```{r}
milk1995 %>%
  summarise(middle = median(milk_million))
```
**The top producing state of 1995:**
```{r}
milk1995 %>% 
  select(state,milk_million) %>% 
  filter(milk_million == max(milk_million))
```
**The state that produced the least in 1995:**
```{r}
milk1995 %>% 
  select(state,milk_million) %>%
  filter(milk_million == min(milk_million))
```


#### Name's Plot

```{r}
#plot here
```

**The average milk produced in year:**
```{r}
#calc avg
```
**The median milk produced in year:**
```{r}
#calc median
```
**The top producing state of year:**
```{r}
#calc max
```
**The state that produced the least in year:**
```{r}
#calc min
```


#### Name's Plot

```{r}
#plot here
```

**The average milk produced in year:**
```{r}
#calc avg
```
**The median milk produced in year:**
```{r}
#calc median
```
**The top producing state of year:**
```{r}
#calc max
```
**The state that produced the least in year:**
```{r}
#calc min
```


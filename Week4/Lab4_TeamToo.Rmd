---
title: "Lab 4: Smoking and Low Birth Weight?"
author: "Brian Teklits, Charles Doremieux, Andrew MacLean, Clint LaBattaglia"             
date: "9/20/2019"
output: html_document
---
```{r setup,include=FALSE}
library(tidyverse)
babies <- read_csv("https://raw.githubusercontent.com/ervance1/Sp2018-Data-Science-repo/master/babies2a.dat")
babies <- rename(babies, bwtoz = `bwt/oz`)
babies2 <- filter(babies,!is.na(smoke))
#View(babies)
View(babies2)
```

### The Main Questions

**The Question:** Does Smoking Lead to Babies Born Prematurely and with Low Birth Weight?

#### Premature births

**Why the question is important:** 

  It is important to ask such questions in order to fully understand the affects of smoking to babies. By researching and analyzing data we can notice trends that will allows us to clearly see the results of smoking. We want to analyze this data in order to warn and inform women of the consequences. If smoking truly leads to premature birth than women should be aware of their choices and morale obligations. 

**Why the answer is relevant:**

  We focus on this question in order to change the future of pregnant smoking. By analyzing trends and examining these questions, we can inform women about the dangers of smoking while pregnant and hopefully prevent any unwarrented problems with new borns.
  
#### Birth weight

**Why the question is important:** 

For the sake of humanity and morality, babies shoukd not be born with defects because of the choices of their parents. For research sakes and to inform mothers of these defects, this questions is important because the results could be used to prevent babies being born prematurely or underweight. 

**Why the answer is relevant:**

This question is relevant because everyday babies are being born prematurely and underweight because their mothers smoked during pregnancy. We hope that by addressing this question and informing the general public that smoking while pregnant can have after-lasting effects on new borns.

#### Analysis of premature births

```{r Team Plot1,echo=TRUE, warning=FALSE}
prem <- filter(babies2,Premature==1)
ggplot(prem,aes(smoke))+
  geom_bar(aes(fill=factor(smoke)))+
  geom_text(stat='count', aes(label=..count..),color='white', vjust=2)+
  ggtitle("Premature Births for Non-Smokers and Smokers")+
  scale_fill_discrete(name = "Smoking Usage", labels = c("Non-Smokers", "Smokers"))+
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+
  ylab("Number of Mothers")
```

**Surgeon General's Assertion:** Mothers who smoke have increased rates of premature delivery (before 270 days).

**The answer:** There are 194 premature births for which we have data on the mother's smoking habits. In 103 cases the mother was smoking during the pregnancy, accounting for about 53% of premature births.

This supports the Surgeon General's claim, as we have a notable disparity which seems to relate to smoking habits. However, 47% of mothers did not smoke, but still gave birth prematurely, suggesting there are other factors which influence premature births, some of which we'll investigate later.

#### Analysis of birth weights at gestational ages

```{r Team Plot2,echo=TRUE, warning=FALSE}
bool_smoke <- as_labeller(c(`0` = "Non Smokers", `1` = "Smokers"))
ggplot(babies2)+
  stat_density_2d(aes(x=gestation,y=bwtoz,fill=..level..),geom = "polygon")+
  geom_vline(aes(xintercept=270),color="red")+
  facet_wrap(~smoke,labeller=bool_smoke)+
  xlab("Gestation (days)")+
  ylab("Birth weight (ounces)")+
  scale_fill_continuous(name="Proportion")
```

**Surgeon General's Assertion:** The newborns of mothers who smoke have smaller birth weights at every gestational age (number of days into pregnancy when child is born).

**The answer:** The red line indicates 270 days gestation, the cutoff date for premature births. We find that for non-smokers, births are most common at about 125 ounces, and just over 280 days. As we move away from this area, outliers are fairly evenly distributed on both ends of birth weight and gestational age. Notable outliers are the cluster of very premature births, a seperate island from the main distribution.

For smokers, the births are most common at around 120 ounces, and just under 280 days. Birth weights are lower at almost all ages, except in a handful of cases of postmature birth, with over 300 days gestation. In particular, we note that the smoker dataset is much more spread out on the lower end of birth weights, with lower occurances on the high end. Premature and underweight babies are much more common, and the weights of the premature babies are much lower than in the non-smoker dataset.

Our data supports the Surgeon General's assertion, outside a possible exception for very postmature births at over 300 days.

### Recommendations 

Summarize answers to surgeon general's assertions above

In this dataset, the group of women considered underweight by BMI is largely made up of smokers. Underweight women need to pay special attention to their weight to avoid complications during pregnancy. Without additional data on the mother's weight throughout the pregnancy, we cannot say for certain what effect this has on birth weight or premature birth. So, BMI may be a factor influencing our determinations that smoking increases the chance of premature birth and leads to lower birth weights.

### Preliminary Question

**The Question:** Which variables are similar between smokers and nonsmokers? Which are different?

```{r}
# cor.test(babies$smoke, babies$gestation) #-0.05199957
# cor.test(babies$smoke, babies$bwtoz) #-0.2391704
# cor.test(babies$smoke, babies$parity) #-0.01139381 
# cor.test(babies$smoke, babies$mrace) #-0.1142484 
# cor.test(babies$smoke, babies$mage) #-0.07929847 
# cor.test(babies$smoke, babies$med) #-0.1259615
# cor.test(babies$smoke, babies$mht) #0.03448153
# cor.test(babies$smoke, babies$mpregwt) #-0.06906512
# cor.test(babies$smoke, babies$drace) #-0.08036823
# cor.test(babies$smoke, babies$dage) #-0.09138941
# cor.test(babies$smoke, babies$ded) #-0.04533623
# cor.test(babies$smoke, babies$dht) #0.07334144
# cor.test(babies$smoke, babies$dwt) #0.01554045
# cor.test(babies$smoke, babies$marital) #0.01327127
# cor.test(babies$smoke, babies$inc) #0.01275076
# cor.test(babies$smoke, babies$time)
# cor.test(babies$smoke, babies$number) #0.8096594
# cor.test(babies$smoke, babies$Premature) #0.05775238

ggplot(data = babies)+
  geom_bar(mapping = aes(x = mht, color = smoke))+
  facet_wrap(~smoke)

ggplot(data = babies)+
  geom_bar(mapping = aes(x = mht, color = smoke))+
  facet_wrap(~smoke)

ggplot(data = babies)+
  geom_bar(mapping = aes(x = mht, color = smoke))+
  facet_wrap(~smoke)

ggplot(data = babies)+
  geom_bar(mapping = aes(x = mht, color = smoke))+
  facet_wrap(~smoke)

```

Different: Mother's age, Mother's and Father's education, income (not median) but higher quartile, parity (more avg children among smokers), 

Similar: Father's ages, not identical
Unsure: races, marital

```{r Team Plot3,echo=TRUE, warning=FALSE}
plot3 <- ggplot(babies2)
#plot3+geom_bar(aes(med))+facet_wrap(~smoke) less higher education among smokers also plot3+geom_bar(aes(ded))+facet_wrap(~smoke)
plot3+geom_boxplot(aes(smoke,mage,group=smoke)) 
#plot3+geom_bar(aes(parity))+facet_wrap(~smoke) fewer smokers with low num of pregnancies
#plot3+geom_density(aes(dwt))+facet_wrap(~smoke) similar to mothers
```


### Individual Findings and Plots

#### Brian's Plot

```{r Brian, echo=TRUE, warning=FALSE}
with_bmi <- mutate(babies, BMI =703*(mpregwt/(mht)^2))
without_na <- filter(with_bmi, !is.na(smoke))
ggplot((without_na))+
  geom_density(aes(BMI,group=smoke,fill=factor(smoke)), position="stack")+
  geom_vline(xintercept=18.5,color = 'black')+
  geom_vline(xintercept=25,color = 'black')+
  geom_vline(xintercept=30,color = 'black')+
  scale_fill_discrete(name = "Smoking Usage", labels = c("Non-Smokers", "Smokers"))
```

**Individual Findings:** The black lines denote relevant categories of BMI for women. A BMI less than 18.5 is considered underweight, between 18.5 and 25 is healthy, over 25 is overweight, and over 30 is obese. 

There are a few interesting things to note:

* Most underweight women are smokers
* A similar proportion of non-smokers and smokers are overweight
* Few women in either category are obese

Since the underweight population is the most notable difference between the two groups, we'll focus on this subset.

Being underweight can cause issues, in particular premature birth[^1]. Mothers must take care to gain enough weight, and at an appropriate rate. Without further data on the mother's overall weight gain and rates of weight gain during the pregnancy, we cannot say for certain the effect of being underweight pre-pregnancy. However, this is a potential factor which could explain the higher rates of premature births among smokers.

[^1]:[Does being underweight pose any risks to me or my baby?](https://americanpregnancy.org/pregnancy-health/eating-for-two/)

#### Individual Plot

```{r  echo=TRUE, warning=FALSE}


```

**Individual Findings:**

#### Individual Plot

```{r  echo=TRUE, warning=FALSE}


```

**Individual Findings:**

#### Individual Plot

```{r  echo=TRUE, warning=FALSE}


```

**Individual Findings:**
 
### Summary of Individual Contributions
<!--Note what non default aesthetics and layers used--> 
**Brian Teklits:** 

**Andrew:** 

**Clint:** 

**Charles:** 

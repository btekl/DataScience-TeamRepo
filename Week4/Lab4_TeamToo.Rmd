---
title: "Lab 4: Smoking and Low Birth Weight?"
author: "Brian Teklits, Charles Doremieux, Andrew MacLean, Clint LaBattaglia"             
date: "9/20/2019"
output: html_document
---
```{r setup,include=FALSE}
library(tidyverse)
babies <- read_csv("https://raw.githubusercontent.com/ervance1/Sp2018-Data-Science-repo/master/babies2a.dat")
babies <- rename(babies, bwtoz = `bwt/oz`)
babies2 <- filter(babies,!is.na(smoke))
```

### The Main Questions

**The Question:** Does Smoking Lead to Babies Born Prematurely and with Low Birth Weight?

#### Premature births

**Why the question is important:** It is important to ask such questions in order to fully understand the affects of smoking on babies. By researching and analyzing data we can notice trends that will allows us to clearly see the results of smoking during pregnancy. We want to analyze this data in order to warn and inform women of the consequences. If smoking truly leads to premature birth than women should be aware of their choices and moral obligations. 

**Why the answer is relevant:** By analyzing trends and examining these questions, we can inform women about the dangers of smoking while pregnant and hopefully prevent any unwarranted problems with newborns. In particular, premature births are linked to a myriad of physical, neurological, behavioral, and social developmental issues which can extend well beyond infancy, potentially becoming life long issues. Preventing any such issues before they occur is of paramount importance.
  
#### Birth weight

**Why the question is important:** For the sake of humanity and morality, babies should not be born with defects because of the choices of their parents. Birth weight is of particular concern because it is linked to many serious health issues. Low birth weight babies have greater troubles fighting infection, can require incubation to stay warm, as well as a variety of nervous system issues, respiratory issues, difficulties gaining weight, and increased rates of sudden infant death syndrome.

**Why the answer is relevant:** This question is relevant because everyday babies are being born prematurely and underweight because their mothers smoked during pregnancy. By addressing this question and demonstrating the link between smoking while pregnant and low birth weight, parents can be motivated to make better choices for their babies and themselves.

#### Analysis of premature births

```{r Team Plot1,echo=TRUE, warning=FALSE}
prem <- filter(babies2,Premature==1)
ggplot(prem,aes(smoke))+
  geom_bar(aes(fill=factor(smoke)))+
  geom_text(stat='count', aes(label=..count..),color='white', vjust=2)+
  ggtitle("Premature Births for Non-Smokers and Smokers")+
  scale_fill_discrete(name = "Smoking Usage", labels = c("Non-Smokers", "Smokers"))+
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+
  ylab("Number of Mothers")
```

**Surgeon General's Assertion:** Mothers who smoke have increased rates of premature delivery (before 270 days).

**The answer:** There are 194 premature births for which we have data on the mother's smoking habits. In 103 cases the mother was smoking during the pregnancy, accounting for about 53% of premature births.

This supports the Surgeon General's claim, as we have a notable disparity which seems to relate to smoking habits. However, 47% of mothers did not smoke, but still gave birth prematurely, suggesting there are other factors which influence premature births, some of which we'll investigate later.

#### Analysis of birth weights at gestational ages

```{r Team Plot2,echo=TRUE, warning=FALSE}
bool_smoke <- as_labeller(c(`0` = "Non Smokers", `1` = "Smokers"))
ggplot(babies2)+
  stat_density_2d(aes(x=gestation,y=bwtoz,fill=..level..),geom = "polygon")+
  geom_vline(aes(xintercept=270),color="red")+
  facet_wrap(~smoke,labeller=bool_smoke)+
  xlab("Gestation (days)")+
  ylab("Birth weight (ounces)")+
  scale_fill_continuous(name="Proportion")
```

**Surgeon General's Assertion:** The newborns of mothers who smoke have smaller birth weights at every gestational age (number of days into pregnancy when child is born).

**The answer:** The red line indicates 270 days gestation, the cutoff date for premature births. We find that for non-smokers, births are most common at about 125 ounces, and just over 280 days. As we move away from this area, outliers are fairly evenly distributed on both ends of birth weight and gestational age. Notable outliers are the cluster of very premature births, a seperate island from the main distribution.

For smokers, the births are most common at around 120 ounces, and just under 280 days. Birth weights are lower at almost all ages, except in a handful of cases of postmature birth, with over 300 days gestation. In particular, we note that the smoker dataset is much more spread out on the lower end of birth weights, with lower occurances on the high end. Premature and underweight babies are much more common, and the weights of the premature babies are much lower than in the non-smoker dataset.

Our data supports the Surgeon General's assertion, outside a possible exception for very postmature births at over 300 days.

### Recommendations 

In general, our findings support the Surgeon General's conclusions. Premature births occur at a higher rate among smokers, and birth weights are lower for nearly all gestational ages. A notable exception is postmature births, for which our data shows non-smokers have lower birth weights.

However, there are a number of factors which differ between smokers and non-smokers, which could be influencing these conclusions. 

In this dataset, the group of women considered underweight by BMI is largely made up of smokers. Underweight women need to pay special attention to their weight to avoid complications during pregnancy. Without additional data on the mother's weight throughout the pregnancy, we cannot say for certain what effect this has on birth weight or premature birth. So, BMI may be a factor influencing our determinations that smoking increases the chance of premature birth and leads to lower birth weights.

Additionally, we've found that non-smokers were older on average, smokers on average had one additional prior pregnancy, and a greater proportion of of non-smoking parents completed college. 

The effects of these differences are difficult to measure. Generally, older mothers have more difficulties than younger mothers. Mothers who have had many pregnancies can experience more complications giving birth than those with only a few. However, in our data, we've found a difference of 2 prior pregnancies on average for smokers, versus 1 for non-smokers--both are on the lower end. Finally, educational differences, in our study, are unlikely to influence the decision for mothers to smoke. This data was collected in the 1960's, when the effects of smoking were not as well known in general, and thus are less likely to be influenced by the parent's education.

### Preliminary Question

**The Question:** Which variables are similar between smokers and nonsmokers? Which are different?

There are several variables within the babies data set that are not strongly connected to the smoking of the mother. Variables that we have found to be similar between smokers and non-smokers are race, height (for mother and father), mother's marital status, and birthday of the baby.

Notable differences between smokers and non-smokers are the age of the mother (non-smokers are slightly older on average), BMI (shown in individual section), parity (smokers on average have had one additional pregnancy), and the level of education of both the mother and father (a larger proportion of non-smokers graduated college).

The exact effects of these differences are difficult to gauge, but they present possible unaccounted for variables which may be influencing our determination on the effects of smoking.

```{r Team Plot, echo=TRUE, warning=FALSE}
plot3 <- ggplot(babies2)
plot3+geom_histogram(aes(ded),bins=8)+facet_wrap(~smoke,labeller=bool_smoke)+xlab("Father's level of Education") 
plot3+geom_histogram(aes(med),bins=8)+facet_wrap(~smoke,labeller=bool_smoke)+xlab("Mother's level of Education") 
plot3+geom_boxplot(aes(smoke,mage,group=smoke,middle=mean(mage)))+ylab("Mother's age")
plot3+geom_boxplot(aes(smoke,parity,group=smoke,middle=mean(parity)))+ylab("Number of prior Pregnancies")

```

### Individual Findings and Plots

#### Brian's Plot

```{r Brian, echo=TRUE, warning=FALSE}
with_bmi <- mutate(babies, BMI =703*(mpregwt/(mht)^2))
without_na <- filter(with_bmi, !is.na(smoke))
ggplot((without_na))+
  geom_density(aes(BMI,group=smoke,fill=factor(smoke)), position="stack")+
  geom_vline(xintercept=18.5,color = 'black')+
  geom_vline(xintercept=25,color = 'black')+
  geom_vline(xintercept=30,color = 'black')+
  scale_fill_discrete(name = "Smoking Usage", labels = c("Non-Smokers", "Smokers"))
```

**Individual Findings:** The black lines denote relevant categories of BMI for women. A BMI less than 18.5 is considered underweight, between 18.5 and 25 is healthy, over 25 is overweight, and over 30 is obese. 

There are a few interesting things to note:

* Most underweight women are smokers
* A similar proportion of non-smokers and smokers are overweight
* Few women in either category are obese

Since the underweight population is the most notable difference between the two groups, we'll focus on this subset.

Being underweight can cause issues, in particular premature birth[^1]. Mothers must take care to gain enough weight, and at an appropriate rate. Without further data on the mother's overall weight gain and rates of weight gain during the pregnancy, we cannot say for certain the effect of being underweight pre-pregnancy. However, this is a potential factor which could explain the higher rates of premature births among smokers.

[^1]:[Does being underweight pose any risks to me or my baby?](https://americanpregnancy.org/pregnancy-health/eating-for-two/)

#### Charles' Plot

```{r Charles, echo=TRUE, warning=FALSE}
#cor.test(babies$Premature,babies$time)
ggplot(data = babies, mapping = aes(x = bwtoz, group = smoke, color = smoke))+
  ggtitle("Count of Babyweights for Smokers and Nonsmokers")+
  geom_bar()+
  facet_wrap(~Premature)
```

**Individual Findings:**

This graph demonstrates both the high presence of smokers in premature baby deliveries, but also the large amount of smoking parents present for lighter babies born in-term. The graph is divided by on schedule and premature births and depicts the presence of smokers in each 'count' in blue. The things to note within this graph are that: 1. Many premature births are delivered by smokers and 2. The larger portion of "light" babies are delivered by smokers.

These findings call to importance the dangers of underweight and prematurely born children. Stanford's Children Health suggests that the babies that are at risk for low-birth-weight are commonly the children of parents who smoke use alcohol/drugs. Low birth weight is associated with low oxygen levels, infection, SIDS, etc.[^2] We lack the required data to qualify smoking as the cause of underweight/premature births, though they may play a role in explaining those factors.

[^2]:[Low Birth Weight](https://www.stanfordchildrens.org/en/topic/default?id=low-birthweight-90-P02382)


#### Individual Plot

```{r Andrew, echo=TRUE, warning=FALSE}
ggplot(data = babies)+
  geom_point(mapping = aes(x= gestation, y= bwtoz))+
  geom_smooth(mapping = aes(x= gestation, y = bwtoz), method = lm)+
  facet_grid(.~smoke)+
  xlim(225,325)+
  ggtitle("Birth Weight vs Time of Birth Period")+
  xlab("Birth Period")+
  ylab("Birth Weight (Ounce)")

```

**Individual Findings:**

When looking at the data of current smoking parents and the birth weight of their child, you can see that mothers who currently smoked had higher chances for a premature birth, as well as a higher chance of the baby being born at a lower weight.

The graph can see from the graph labeled "1" that there is stronger postive correlation between birth weight and birth period with mothers who did smoke than mothers who did not currently smoke. If we compare the do at around 270 day in the gestation period, we can see that with mother who do smoke have baby birth avearges just under 100 ounces. Compare to parents who don't smoke and you can tell that their babies' birth weight averages is closer to 117 ounces. There is about a 17 ounce difference between babies born at 270 days into the gestation period between mothers who did or did not smoke cigarettes.

The interesting features of this graph to take notes of are:

1. The stronger correlation between birth weight and birth period for mothers who smoke than those who do not.

2. The difference between the best fit line between the different sets of mothers that display drastic differences between baby birth weight.

From this we can see now that we must inform mothers of their choices and teach future parents that smoking is bad for babies. A study done by Valerie S. Knopik that smoke had a smoke of bad effects towards babies who had parents who smoked such as issues with birth weight and ADHD[^4].

[^4]:[Maternal smoking during pregnancy and child outcomes?](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3581055/)
#### Individual Plot

```{r  echo=TRUE, warning=FALSE}
ggplot(data = babies) + geom_histogram(mapping = aes(x= med, group= smoke, fill = smoke)) + facet_grid(Premature~.) + xlab("Mother's Education Level") + ggtitle("Mother's Education Level in relation to Premature Birth") + scale_fill_gradient(low = "purple", high = "red")  + ylab("Number of Mothers") + ylim(0,225) + coord_flip()
```

**Individual Findings:**
This graph demonstrates the relationship between the mother's education level, smoking, and premature birth of the child. As the education level of the mother increases, the proportion of mothers who smoke decreases suggesting a relationship between education level and likelyhood of smoking. Additionally, the ration of premature births to on term births was lower amongst the college educated and trade school graduate mothers when compared to mothers of lower education levels. These findings suggest that education could be a factor in women choosing to smoke in the first place and related variable to the likelyhood of premature birth. A study conducted by Columbia University researchers for Drug and Alcohol Dependence (a peer reviewed journal) suggests that not only is education a contributing factor in women choosing to smoke at all, but that education is also related to how likely a woman is to smoke during pregnancy. [^3] 
[^3]:[Educational Attainment and Smoking Among Women: Risk Factors and Consequences for Offspring]https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2774716/
 
### Summary of Individual Contributions
<!--Note what non default aesthetics and layers used--> 
**Brian Teklits:** I helped formulate the team plots, in particular using the vline and text geoms to bring additional clarity to the plots. I also implemented the theme method to reduce clutter on the first team plot, as well as the use of filters and mutates to remove NA values and focus plots on particular subsets of data.

**Andrew:** I helped to discuss why these questions are important and relevant. I created a graph that displays the correlations between birth period and birth weight compared between mothers who smoked and did not smoke. I found that on average, babies from mothers who smoked often had children who were born at a lower weight than babies whose mothers did not smoke. I used "method = lm" as an aes function in order to display the best fit line. I also used a facet to compare different sets of data. I used some labeling and limiting functions to clean up the graphs and make them readable.

**Clint:** Initially sought to create a pie chart which compared the percentage of babies born prematurely out of the total number of babies born at each income level but I was unable to figure out how to get R to calculate the percentage of a variable in relation to another variable so I scrapped that idea. Then I examined the functions avaible to me and decided to create a histogram which used the amount of women at each education level and filled in by whether or not they smoked. I then needed to relate this data to the primary questions so I faceted the graph by premature birth. I wanted the proportion of the bars that is either smoking or non-smoking to be as visable as possible so I changed the colors of the scale and flipped the graphs so as to have the chart horizontal. 

**Charles:** Helped formulate plots to determine significance of connections between variables and smoking (e.g. is smoking linked to education?) and formulated a method to compare birthweights of babies from smoking and nonsmoking families. From that point was able to create a connection between mothers smoking and possible health complications.
